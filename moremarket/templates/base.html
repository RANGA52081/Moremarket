{% load static %}
{% load i18n %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>More Market</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
</head>
<body class="bg-light">

<!-- ðŸ” HEADER -->
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top">
    <div class="container">

        <!-- Logo -->
        <a class="navbar-brand brand-logo d-flex align-items-center" href="{% url 'customer_home' %}">
    <img src="{% static 'images/more-market(logo).png' %}" 
         alt="MoreMarket Logo"
         class="brand-img">
    <span class="brand-text">MoreMarket</span>
</a>

        <!-- Mobile Toggle -->
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
            <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Navbar Content -->
        <div class="collapse navbar-collapse" id="navbarContent">

            <!-- Search -->
            <form class="d-flex mx-lg-4 my-2 my-lg-0 flex-grow-1">
                <input class="form-control me-2" type="search" placeholder="Search scaffolding products">
                <button class="btn btn-primary">Search</button>
            </form>

            <!-- Right Icons -->
<div class="d-flex align-items-center gap-4">

    <!-- LOCATION -->
<div class="position-relative location-wrapper">

    <!-- Trigger -->
    <div class="d-flex align-items-center gap-2 location-trigger"
         onclick="toggleLocationDropdown()">

        <i class="bi bi-geo-alt fs-5 text-muted"></i>

        <div class="d-flex flex-column lh-sm">
            <span class="small text-secondary">Deliver to</span>
            <strong id="selected-location">
                {{ request.session.selected_location|default:"India (Any Area)" }}
            </strong>
        </div>
    </div>

    <!-- DROPDOWN -->
    <div id="locationDropdown" class="location-dropdown shadow-lg">

        <div class="d-flex justify-content-between align-items-center mb-3">
            <h6 class="fw-bold m-0">Choose your location</h6>
            <span class="close-btn" onclick="closeLocationDropdown()">âœ•</span>
        </div>

        <!-- SAVED ADDRESSES (If Logged In) -->
        {% if user.is_authenticated and user.addresses.all %}
        <div class="saved-address-section mb-3">
            <small class="text-muted">Your saved addresses</small>

            {% for address in user.addresses.all %}
            <div class="saved-address-card"
                 onclick="selectSavedAddress('{{ address.city }} {{ address.pincode }}')">

                <strong>{{ address.full_name }}</strong><br>
                <small>
                    {{ address.area }}, {{ address.city }},
                    {{ address.state }} - {{ address.pincode }}
                </small>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <!-- Sign In Prompt -->
        {% if not user.is_authenticated %}
        <a href="{% url 'login' %}"
        class="btn btn-warning w-100 mb-3 text-decoration-none">
        Sign in to see your addresses
        </a>
        {% endif %}

        <!-- Divider -->
        <div class="text-center text-muted small mb-2">
            or enter an Indian pincode
        </div>

        <!-- Spinner -->
        <div id="locationSpinner" class="text-center mb-2" style="display:none;">
            <div class="spinner-border spinner-border-sm text-primary"></div>
        </div>

        <!-- PINCODE -->
        <input type="text"
               id="manualPincode"
               class="form-control form-control-sm mb-2"
               placeholder="Enter 6-digit Pincode"
               maxlength="6"
               onblur="fetchFromPincode()">

        <!-- AREA -->
        <input type="text"
               id="manualArea"
               class="form-control form-control-sm mb-2"
               placeholder="Area / Street">

        <!-- CITY -->
        <input type="text"
               id="manualCity"
               class="form-control form-control-sm mb-2"
               placeholder="City">

        <!-- STATE -->
        <input type="text"
               id="manualState"
               class="form-control form-control-sm mb-3"
               placeholder="State">

        <button onclick="applyManualAddress()"
                class="btn btn-primary w-100">
            Save Location
        </button>

        <small id="locationError"
               class="text-danger mt-2 d-block"
               style="display:none;">
            Please enter valid details.
        </small>

        <small class="text-muted mt-2 d-block">
            Delivery options may vary by location.
        </small>

    </div>
</div>
                <!-- CART -->
<a href="{% url 'cart' %}" class="text-dark position-relative text-decoration-none">
    <i class="bi bi-cart3 fs-5"></i>

    {% if cart_count and cart_count > 0 %}
    <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
        {{ cart_count }}
    </span>
    {% endif %}
</a>


{% if user.is_authenticated %}

<!-- USER DROPDOWN -->
<div class="dropdown">

    <div class="d-flex align-items-center gap-2 dropdown-toggle"
         data-bs-toggle="dropdown"
         style="cursor:pointer;">

        <i class="bi bi-person-circle fs-5"></i>

        <div class="d-flex flex-column lh-sm">
            <small class="text-muted">Hello,</small>
            <strong>{{ user.username }}</strong>
        </div>

    </div>

    <ul class="dropdown-menu dropdown-menu-end shadow">

        <li>
            <a class="dropdown-item" href="#">
                My Profile
            </a>
        </li>

        <li>
            <a class="dropdown-item" href="#">
                My Orders
            </a>
        </li>

        <li>
            <a class="dropdown-item" href="#">
                My Addresses
            </a>
        </li>

        <li><hr class="dropdown-divider"></li>

        <li>
            <a class="dropdown-item text-danger"
               href="{% url 'logout' %}">
                Logout
            </a>
        </li>

    </ul>

</div>

{% else %}

<!-- SIGN IN -->
<a href="{% url 'login' %}"
   class="text-decoration-none text-dark d-flex align-items-center gap-1">

    <i class="bi bi-person fs-5"></i>
    <span class="d-none d-md-inline">Sign in</span>

</a>

<!-- CREATE ACCOUNT -->
<a href="{% url 'register' %}"
   class="btn btn-primary d-flex align-items-center gap-2">

    <i class="bi bi-person-plus"></i>
    <span class="d-none d-md-inline">Create account</span>

</a>

{% endif %}

            </div>
        </div>
    </div>
</nav>
<!-- ðŸ§± PAGE CONTENT -->
<main>
    {% block content %}{% endblock %}
</main>
<style>
    .custom-footer {
    background: #263238; /* Dark base */
    color: #FFFFFF;
    padding: 60px 0 30px;
}

.footer-title {
    font-weight: 700;
    color: #FFFFFF;
}

.footer-text {
    color: #B0BEC5;  /* Soft grey */
    font-size: 14px;
    line-height: 1.6;
}

.footer-subtitle {
    font-weight: 600;
    margin-bottom: 15px;
    color: #F7F7F7;
}

/* Links */
.footer-links {
    list-style: none;
    padding: 0;
}

.footer-links li {
    margin-bottom: 10px;
}

.footer-links a {
    text-decoration: none;
    color: #B0BEC5;
    transition: 0.3s ease;
    font-weight: 500;
}

.footer-links a:hover {
    color: #FFFFFF;
    padding-left: 6px;
}

/* Social Icons */
.footer-social a {
    color: #B0BEC5;
    font-size: 20px;
    margin-right: 15px;
    transition: 0.3s ease;
}

.footer-social a:hover {
    color: #FFFFFF;
    transform: translateY(-3px);
}

/* Divider */
.footer-divider {
    border-color: rgba(176,190,197,0.2);
    margin: 30px 0 20px;
}

/* Bottom text */
.footer-bottom {
    text-align: center;
    font-size: 13px;
    color: #B0BEC5;
}
</style>
<!-- ðŸ¦¶ ADVANCED FOOTER -->
<footer class="custom-footer bg-dark text-light pt-5">

    <div class="container">

        <div class="row g-5">

            <!-- COLUMN 1 -->
            <div class="col-lg-3 col-md-6">
                <h6 class="footer-heading">USEFUL LINKS</h6>
                <ul class="footer-links list-unstyled">
                    <li><a href="#">Certification</a></li>
                    <li><a href="#">Products</a></li>
                    <li><a href="#">About Us</a></li>
                    <li><a href="#">Project Gallery</a></li>
                    <li><a href="#">Get A Quick Quote</a></li>
                </ul>
            </div>

            <!-- COLUMN 2 -->
            <div class="col-lg-4 col-md-6">
                <h6 class="footer-heading">LOCATIONS</h6>

                <div class="footer-location">
                    <strong>CHENNAI</strong><br>
                    Sales Office: T Nagar, Chennai 600017<br>
                    Warehouse: Ambattur Industrial Estate
                </div>

                <div class="footer-location mt-3">
                    <strong>BANGALORE</strong><br>
                    Warehouse: Peenya Industrial Area
                </div>

                <div class="footer-location mt-3">
                    <strong>HYDERABAD</strong><br>
                    Office: Madhapur
                </div>
            </div>

            <!-- COLUMN 3 -->
            <div class="col-lg-2 col-md-6">
                <h6 class="footer-heading">FIND US</h6>

                <div class="footer-social mt-3">
                    <a href="#"><i class="bi bi-facebook"></i></a>
                    <a href="#"><i class="bi bi-instagram"></i></a>
                    <a href="#"><i class="bi bi-linkedin"></i></a>
                </div>
            </div>

            <!-- COLUMN 4 -->
            <div class="col-lg-3 col-md-6">
                <h6 class="footer-heading">NEWSLETTER</h6>

                <p class="small">
                    Want the best deals straight to your inbox?
                </p>

                <form>
                    <input type="text" class="form-control mb-2" placeholder="First Name">
                    <input type="email" class="form-control mb-2" placeholder="Email">

                    <div class="form-check small mb-2">
                        <input class="form-check-input" type="checkbox" id="agree">
                        <label class="form-check-label" for="agree">
                            I agree to terms & conditions
                        </label>
                    </div>

                    <button type="submit" class="btn btn-secondary w-100">
                        SUBSCRIBE
                    </button>
                </form>
            </div>

        </div>

        <!-- PAYMENT SECTION -->
        <div class="row mt-5 text-center">
            <div class="col">
                <p class="mb-2">We accept</p>

                <div class="payment-icons d-flex justify-content-center gap-3 flex-wrap">
                    <img src="{% static 'images/master-card.png' %}" height="40">
                    <img src="{% static 'images/visa.png' %}" height="40">
                    <img src="{% static 'images/paypal.png' %}" height="40">
                    <img src="{% static 'images/bank-transfer.png' %}" height="40">
                </div>
            </div>
        </div>

        <!-- BOTTOM LINKS -->
        <div class="row mt-4 pt-3 border-top text-center small">
            <div class="col">
                <a href="#" class="text-light me-3">FAQ</a>
                <a href="#" class="text-light me-3">Warranty</a>
                <a href="#" class="text-light me-3">Shipping & Returns</a>
                <a href="#" class="text-light me-3">Terms & Conditions</a>
                <a href="#" class="text-light me-3">Privacy Policy</a>
            </div>
        </div>

        <!-- COPYRIGHT -->
        <div class="text-center mt-3 small">
            Â© 2026 MoreMarket. All Rights Reserved.
        </div>

    </div>

</footer>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- Custom JS -->
<script src="{% static 'js/main.js' %}"></script>

</body>
</html>