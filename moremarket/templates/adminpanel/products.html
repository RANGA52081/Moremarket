{% extends "adminpanel/base_admin.html" %}

{% block content %}

<h2 class="mb-4">Products</h2>

<a href="{% url 'adminpanel:product_create' %}" 
   class="btn btn-primary mb-3">
    Add Product
</a>

<table class="table table-bordered table-hover align-middle">

    <thead class="table-dark">
        <tr>
            <th style="width:120px;">Image</th>
            <th>Name</th>
            <th>Category</th>
            <th>Status</th>
            <th style="width:150px;">Actions</th>
        </tr>
    </thead>

    <tbody>
    {% for product in page_obj %}
        <tr>

            <!-- IMAGE COLUMN -->
            <td>
                {% with product.images.first as first_image %}
                    {% if first_image %}
                        <img src="{{ first_image.image.url }}"
                             width="70"
                             height="70"
                             style="object-fit: cover; border-radius: 8px;">
                    {% else %}
                        <span class="text-muted">No Image</span>
                    {% endif %}
                {% endwith %}
            </td>

            <td>{{ product.name }}</td>

            <td>{{ product.get_category_display }}</td>

            <td>
                {% if product.is_active %}
                    <span class="badge bg-success">Active</span>
                {% else %}
                    <span class="badge bg-danger">Inactive</span>
                {% endif %}
            </td>

            <td>
                <a href="{% url 'adminpanel:product_edit' product.id %}"
                   class="btn btn-sm btn-warning">
                   Edit
                </a>

                <a href="{% url 'adminpanel:product_delete' product.id %}"
                   class="btn btn-sm btn-danger">
                   Delete
                </a>
            </td>

        </tr>
    {% empty %}
        <tr>
            <td colspan="5" class="text-center text-muted">
                No products found.
            </td>
        </tr>
    {% endfor %}
    </tbody>

</table>

<!-- Pagination -->
<div class="mt-3">
    {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}"
           class="btn btn-outline-secondary btn-sm">Previous</a>
    {% endif %}

    <span class="mx-2">
        Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
    </span>

    {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}"
           class="btn btn-outline-secondary btn-sm">Next</a>
    {% endif %}
</div>

{% endblock %}